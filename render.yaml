services:
  - type: web
    name: consultorio-backend
    runtime: node
    buildCommand: yarn install
    startCommand: npm run start
    autoDeploy: true
    envVars:
      - key: NODE_ENV
        value: production
      - key: MONGODB_URI
        sync: false
      - key: JWT_SECRET
        sync: false
      - key: JWT_ISSUER
        value: consultorio-app
      - key: JWT_EXPIRES_IN
        value: 12h
      - key: FRONTEND_URL
        sync: false
      - key: CORS_ORIGINS
        sync: false
      - key: LOG_LEVEL
        value: info

  - type: cron
    name: keep-alive
    runtime: node
    schedule: "*/10 * * * *"  # Cada 10 minutos
    buildCommand: yarn install
    startCommand: "node -e \"fetch('https://consultorio-25.onrender.com/api/public/health').then(r=>{console.log('status', r.status);}).catch(e=>{console.error(e);process.exit(1);})\""
